aes(x = x, y = y, label = c("a", "b", "b"))) + theme_bw()
visits
fruit_rem <- ggplot(data = plants, aes(x = population, y = fruit_rem)) +
geom_jitter(position = position_jitter(0.2), color = "orange",
alpha = 0.6, size = 2) +
geom_boxplot(color = "black", outlier.shape = NA, width = 0.5, alpha = 0.3) +
xlab("Urbanisation level") + ylab("Fruit crop size") +
geom_text(data = data.frame(x = 1:3, y = c(100, 100, 100)),
aes(x = x, y = y, label = c("a", "b", "b"))) + theme_bw()
fruit_rem
max(plants$fruit_rem)
fruit_rem <- ggplot(data = plants, aes(x = population, y = fruit_rem)) +
geom_jitter(position = position_jitter(0.2), color = "orange",
alpha = 0.6, size = 2) +
geom_boxplot(color = "black", outlier.shape = NA, width = 0.5, alpha = 0.3) +
xlab("Urbanisation level") + ylab("Fruit crop size") +
geom_text(data = data.frame(x = 1:3, y = c(112, 112, 112)),
aes(x = x, y = y, label = c("a", "b", "b"))) + theme_bw()
fruit_rem
fruit_rem <- ggplot(data = plants, aes(x = population, y = fruit_rem)) +
geom_jitter(position = position_jitter(0.2), color = "orange",
alpha = 0.6, size = 2) +
geom_boxplot(color = "black", outlier.shape = NA, width = 0.5, alpha = 0.3) +
xlab("Urbanisation level") + ylab("Fruit crop size") +
geom_text(data = data.frame(x = 1:3, y = c(28, 75, 28)),
aes(x = x, y = y, label = c("a", "b", "b"))) + theme_bw()
fruit_rem
fruit_rem <- ggplot(data = plants, aes(x = population, y = fruit_rem)) +
geom_jitter(position = position_jitter(0.2), color = "orange",
alpha = 0.6, size = 2) +
geom_boxplot(color = "black", outlier.shape = NA, width = 0.5, alpha = 0.3) +
xlab("Urbanisation level") + ylab("Fruit crop size") +
geom_text(data = data.frame(x = 1:3, y = c(12, 75, 28)),
aes(x = x, y = y, label = c("a", "b", "b"))) + theme_bw()
fruit_rem
fruit_rem <- ggplot(data = plants, aes(x = population, y = fruit_rem)) +
geom_jitter(position = position_jitter(0.2), color = "orange",
alpha = 0.6, size = 2) +
geom_boxplot(color = "black", outlier.shape = NA, width = 0.5, alpha = 0.3) +
xlab("Urbanisation level") + ylab("Fruit crop size") +
geom_text(data = data.frame(x = 1:3, y = c(15, 75, 28)),
aes(x = x, y = y, label = c("a", "b", "b"))) + theme_bw()
fruit_rem
visits <- ggplot(data = plants, aes(x = population, y = visits)) +
geom_jitter(position = position_jitter(0.2), color = "orange",
alpha = 0.6, size = 2) +
geom_boxplot(color = "black", outlier.shape = NA, width = 0.5, alpha = 0.3) +
xlab("Urbanisation level") + ylab("Fruit crop size") +
geom_text(data = data.frame(x = 1:3, y = c(6, 6, 6)),
aes(x = x, y = y, label = c("a", "b", "b"))) + theme_bw()
visits
visits <- ggplot(data = plants, aes(x = population, y = visits)) +
geom_jitter(position = position_jitter(0.2), color = "orange",
alpha = 0.6, size = 2) +
geom_boxplot(color = "black", outlier.shape = NA, width = 0.5, alpha = 0.3) +
xlab("Urbanisation level") + ylab("Fruit crop size") +
geom_text(data = data.frame(x = 1:3, y = c(0.5, 1.2, 0.5)),
aes(x = x, y = y, label = c("a", "b", "b"))) + theme_bw()
visits
visits <- ggplot(data = plants, aes(x = population, y = visits)) +
geom_jitter(position = position_jitter(0.2), color = "orange",
alpha = 0.6, size = 2) +
geom_boxplot(color = "black", outlier.shape = NA, width = 0.5, alpha = 0.3) +
xlab("Urbanisation level") + ylab("Fruit crop size") +
geom_text(data = data.frame(x = 1:3, y = c(0.5, 1.4, 0.5)),
aes(x = x, y = y, label = c("a", "b", "b"))) + theme_bw()
visits
mrem <- glm.nb(fruit_rem ~ population, data = plants)
anova(mrem)
multrem <- glht(mrem, linfct = mcp(population = "Tukey"))
library(multcomp)
mrem <- glm.nb(fruit_rem ~ population, data = plants)
anova(mrem)
multrem <- glht(mrem, linfct = mcp(population = "Tukey"))
summary(multrem)
fruit_rem <- ggplot(data = plants, aes(x = population, y = fruit_rem)) +
geom_jitter(position = position_jitter(0.2), color = "orange",
alpha = 0.6, size = 2) +
geom_boxplot(color = "black", outlier.shape = NA, width = 0.5, alpha = 0.3) +
xlab("Urbanisation level") + ylab("Fruit crop size") +
geom_text(data = data.frame(x = 1:3, y = c(15, 75, 28)),
aes(x = x, y = y, label = c("a", "b", "c"))) + theme_bw()
fruit_rem
multvisits <- glht(mvisits, linfct = mcp(population = "Tukey"))
summary(multvisits)
visits <- ggplot(data = plants, aes(x = population, y = visits)) +
2+2
mrem <- glm.nb(fruit_rem ~ population, data = plants)
anova(mrem)
multrem <- glht(mrem, linfct = mcp(population = "Tukey"))
summary(multrem)
mvisits <- glm(visits ~ population, family = poisson, data = plants)
anova(mvisits)
multvisits <- glht(mvisits, linfct = mcp(population = "Tukey"))
summary(multvisits)
visits <- ggplot(data = plants, aes(x = population, y = visits)) +
geom_jitter(position = position_jitter(0.2), color = "orange",
alpha = 0.6, size = 2) +
geom_boxplot(color = "black", outlier.shape = NA, width = 0.5, alpha = 0.3) +
xlab("Urbanisation level") + ylab("Fruit crop size") +
geom_text(data = data.frame(x = 1:3, y = c(0.5, 1.4, 0.5)),
aes(x = x, y = y, label = c("a", "b", "ab"))) + theme_bw()
visits
anova(mvisits, test = "Chisq")
mvisits <- glm(visits ~ population, family = poisson, data = plants)
anova(mvisits, test = "Chisq")
multvisits <- glht(mvisits, linfct = mcp(population = "Tukey"))
summary(multvisits)
mrem <- glm.nb(fruit_rem ~ population, data = plants)
anova(mrem)
multrem <- glht(mrem, linfct = mcp(population = "Tukey"))
summary(multrem)
visits <- ggplot(data = plants, aes(x = population, y = visits)) +
geom_jitter(position = position_jitter(0.2), color = "orange",
alpha = 0.6, size = 2) +
geom_boxplot(color = "black", outlier.shape = NA, width = 0.5, alpha = 0.3) +
xlab("Population") + ylab("Fruit crop size") +
geom_text(data = data.frame(x = 1:3, y = c(0.5, 1.4, 0.5)),
aes(x = x, y = y, label = c("a", "b", "ab"))) + theme_bw()
fruit_rem <- ggplot(data = plants, aes(x = population, y = fruit_rem)) +
geom_jitter(position = position_jitter(0.2), color = "orange",
alpha = 0.6, size = 2) +
geom_boxplot(color = "black", outlier.shape = NA, width = 0.5, alpha = 0.3) +
xlab("Population") + ylab("Fruit crop size") +
geom_text(data = data.frame(x = 1:3, y = c(15, 75, 28)),
aes(x = x, y = y, label = c("a", "b", "b"))) + theme_bw()
ggarrange(visits, fruit_rem, nrow = 2, ncol = 1)
library(ggpubr)
visits <- ggplot(data = plants, aes(x = population, y = visits)) +
geom_jitter(position = position_jitter(0.2), color = "orange",
alpha = 0.6, size = 2) +
geom_boxplot(color = "black", outlier.shape = NA, width = 0.5, alpha = 0.3) +
xlab("Population") + ylab("Number of visits") +
geom_text(data = data.frame(x = 1:3, y = c(0.5, 1.4, 0.5)),
aes(x = x, y = y, label = c("a", "b", "ab"))) + theme_bw()
fruit_rem <- ggplot(data = plants, aes(x = population, y = fruit_rem)) +
geom_jitter(position = position_jitter(0.2), color = "orange",
alpha = 0.6, size = 2) +
geom_boxplot(color = "black", outlier.shape = NA, width = 0.5, alpha = 0.3) +
xlab("Population") + ylab("Number of fruits pecked") +
geom_text(data = data.frame(x = 1:3, y = c(15, 75, 28)),
aes(x = x, y = y, label = c("a", "b", "b"))) + theme_bw()
ggarrange(visits, fruit_rem, nrow = 2, ncol = 1)
library(ggpubr)
visits <- ggplot(data = plants, aes(x = population, y = visits)) +
geom_jitter(position = position_jitter(0.2), color = "orange",
alpha = 0.6, size = 2) +
geom_boxplot(color = "black", outlier.shape = NA, width = 0.5, alpha = 0.3) +
xlab("Population") + ylab("Number of visits") +
geom_text(data = data.frame(x = 1:3, y = c(0.5, 1.4, 0.5)),
aes(x = x, y = y, label = c("a", "b", "ab"))) + theme_bw()
fruit_rem <- ggplot(data = plants, aes(x = population, y = fruit_rem)) +
geom_jitter(position = position_jitter(0.2), color = "orange",
alpha = 0.6, size = 2) +
geom_boxplot(color = "black", outlier.shape = NA, width = 0.5, alpha = 0.3) +
xlab("Population") + ylab("Number of fruits pecked") +
geom_text(data = data.frame(x = 1:3, y = c(15, 75, 28)),
aes(x = x, y = y, label = c("a", "b", "b"))) + theme_bw()
ggarrange(visits, fruit_rem, nrow = 2, ncol = 1)
ggarrange(visits, fruit_rem, nrow = 1, ncol = 2)
ggarrange(visits, fruit_rem, nrow = 1, ncol = 2)
plants <- read.table("C:/RD/Palacio&Ordano_plants_urbanisation.txt", head = TRUE)
plants$population <- as.factor(plants$population)
sugar <- read.table("C:/RD/Palacio&Ordano_sugar_urbanisation.txt", head = T)
pulp <- subset(sugar, sample_type == "pulp")
peel <- subset(sugar, sample_type == "peel")
crop <- ggplot(data = plants, aes(x = population, y = crop)) +
geom_jitter(position = position_jitter(0.2), color = "orange",
alpha = 0.6, size = 2) +
geom_boxplot(color = "black", outlier.shape = NA, width = 0.5, alpha = 0.3) +
xlab("Population") + ylab("Fruit crop size") +
geom_text(data = data.frame(x = 1:3, y = c(30, 130, 110)),
aes(x = x, y = y, label = c("a", "b", "b"))) + theme_bw()
length <- ggplot(data = plants, aes(x = population, y = length)) +
geom_jitter(position = position_jitter(0.2), color = "orange",
alpha = 0.6, size = 2) +
geom_boxplot(color = "black", outlier.shape = NA, width = 0.5, alpha = 0.3) +
xlab("Population") + ylab("Plant length (m)") +
geom_text(data = data.frame(x = 1:3, y = c(7, 5.2, 10.2)),
aes(x = x, y = y, label = c("a", "a", "b"))) + theme_bw()
diam <- ggplot(data = fruits, aes(x = population, y = diam)) +
geom_jitter(position = position_jitter(0.2), color = "orange",
alpha = 0.6, size = 2) +
geom_boxplot(color = "black", outlier.shape = NA, width = 0.5, alpha = 0.3) +
xlab("Population") + ylab("Fruit diameter (mm)") +
geom_text(data = data.frame(x = 1:3, y = c(44, 52, 47)),
aes(x = x, y = y, label = c("a", "b", "a"))) + theme_bw()
fruits <- read.table("C:/RD/Palacio&Ordano_fruits_urbanisation.txt", head = T)
crop <- ggplot(data = plants, aes(x = population, y = crop)) +
geom_jitter(position = position_jitter(0.2), color = "orange",
alpha = 0.6, size = 2) +
geom_boxplot(color = "black", outlier.shape = NA, width = 0.5, alpha = 0.3) +
xlab("Population") + ylab("Fruit crop size") +
geom_text(data = data.frame(x = 1:3, y = c(30, 130, 110)),
aes(x = x, y = y, label = c("a", "b", "b"))) + theme_bw()
length <- ggplot(data = plants, aes(x = population, y = length)) +
geom_jitter(position = position_jitter(0.2), color = "orange",
alpha = 0.6, size = 2) +
geom_boxplot(color = "black", outlier.shape = NA, width = 0.5, alpha = 0.3) +
xlab("Population") + ylab("Plant length (m)") +
geom_text(data = data.frame(x = 1:3, y = c(7, 5.2, 10.2)),
aes(x = x, y = y, label = c("a", "a", "b"))) + theme_bw()
diam <- ggplot(data = fruits, aes(x = population, y = diam)) +
geom_jitter(position = position_jitter(0.2), color = "orange",
alpha = 0.6, size = 2) +
geom_boxplot(color = "black", outlier.shape = NA, width = 0.5, alpha = 0.3) +
xlab("Population") + ylab("Fruit diameter (mm)") +
geom_text(data = data.frame(x = 1:3, y = c(44, 52, 47)),
aes(x = x, y = y, label = c("a", "b", "a"))) + theme_bw()
seedn <- ggplot(data = fruits, aes(x = population, y = seedn)) +
geom_jitter(position = position_jitter(0.2), color = "orange",
alpha = 0.6, size = 2) +
geom_boxplot(color = "black", outlier.shape = NA, width = 0.5, alpha = 0.3) +
xlab("Population") + ylab("Seed number") +
geom_text(data = data.frame(x = 1:3, y = c(315, 350, 360)),
aes(x = x, y = y, label = c("ns", "ns", "ns"))) + theme_bw()
pulp_bx <- ggplot(data = pulp, aes(x = population, y = sugar_bx_obs)) +
geom_jitter(position = position_jitter(0.2), color = "orange",
alpha = 0.6, size = 2) +
geom_boxplot(color = "black", outlier.shape = NA, width = 0.5, alpha = 0.3) +
xlab("Population") + ylab("Pulp soluble carbohydrate content (ºBx)") +
geom_text(data = data.frame(x = 1:3, y = c(22, 30, 29)),
aes(x = x, y = y, label = c("a", "b", "c"))) + theme_bw()
peel_bx <- ggplot(data = peel, aes(x = population, y = true_sugar_bx)) +
geom_jitter(position = position_jitter(0.2), color = "orange",
alpha = 0.6, size = 2) +
geom_boxplot(color = "black", outlier.shape = NA, width = 0.5, alpha = 0.3) +
xlab("Population") + ylab("Peel soluble carbohydrate content (ºBx)") +
geom_text(data = data.frame(x = 1:3, y = c(5, 8.7, 8)),
aes(x = x, y = y, label = c("a", "b", "b"))) + theme_bw()
ggarrange(crop, length, diam, seedn, pulp_bx, peel_bx, nrow = 3, ncol = 3)
plants <- read.table("C:/RD/Palacio&Ordano_plants_urbanisation.txt", head = TRUE)
plants$population <- as.factor(plants$population)
setwd("C:/Users/54221/Dropbox/GitHub/Passiflora_urbanisation")
# Suppress messages, warnings and errors for document aesthetics.
knitr::opts_chunk$set(message = FALSE, warning = FALSE, error = FALSE, echo = TRUE)
plants <- read.table("data/Palacio&Ordano_plants_urbanisation.txt", head = TRUE)
plants$population <- as.factor(plants$population)
plants %>% group_by(population) %>% summarise(Wfruit_removal = mean(fruit_rem),
Ifruit_removal = var(fruit_rem/mean(fruit_rem)),
n_plants = dplyr::n(),
sdIfruit_removal = Ifruit_removal/(2*n_plants)) %>%
knitr::kable(., caption = "Opportunity for selection", digits = 2)
library8dplyr
library(dplyr)
library(ggplot2)
library(MVN)
plants <- read.table("data/Palacio&Ordano_plants_urbanisation.txt", head = TRUE)
plants$population <- as.factor(plants$population)
plants %>% group_by(population) %>% summarise(Wfruit_removal = mean(fruit_rem),
Ifruit_removal = var(fruit_rem/mean(fruit_rem)),
n_plants = dplyr::n(),
sdIfruit_removal = Ifruit_removal/(2*n_plants)) %>%
knitr::kable(., caption = "Opportunity for selection", digits = 2)
plants <- plants %>% group_by(population) %>% mutate(wrel = fruit_rem/mean(fruit_rem))
bartlett.test(wrel ~ population, data = plants)
urban <- subset(plants, population == "urban")
semiurban <- subset(plants, population == "semiurban")
rural <- subset(plants, population == "rural")
# Urban
urban$W <- urban$fruit_rem
urban$wrel <- urban$W/mean(urban$W)
urban$x1 <- log(urban$crop)
urban$x2 <- urban$x.diam
urban$x3 <- urban$x.nseeds
urban$x4 <- urban$x.peel.sugar
urban$z1 <- (urban$x1 - mean(urban$x1, na.rm = T))/sd(urban$x1, na.rm = T)
urban$z2 <- (urban$x2 - mean(urban$x2, na.rm = T))/sd(urban$x2, na.rm = T)
urban$z3 <- (urban$x3 - mean(urban$x3, na.rm = T))/sd(urban$x3, na.rm = T)
urban$z4 <- (urban$x4 - mean(urban$x4, na.rm = T))/sd(urban$x4, na.rm = T)
# Semiurban
semiurban$W <- semiurban$fruit_rem
semiurban$wrel <- semiurban$W/mean(semiurban$W)
semiurban$x1 <- log(semiurban$crop)
semiurban$x2 <- semiurban$x.diam
semiurban$x3 <- semiurban$x.nseeds
semiurban$x4<- semiurban$x.peel.sugar
semiurban$z1 <- (semiurban$x1 - mean(semiurban$x1, na.rm =T))/sd(semiurban$x1, na.rm = T)
semiurban$z2 <- (semiurban$x2 - mean(semiurban$x2, na.rm =T))/sd(semiurban$x2, na.rm = T)
semiurban$z3 <- (semiurban$x3 - mean(semiurban$x3, na.rm =T))/sd(semiurban$x3, na.rm = T)
semiurban$z4 <- (semiurban$x4 - mean(semiurban$x4, na.rm =T))/sd(semiurban$x4, na.rm = T)
# Rural
rural$W <- rural$fruit_rem
rural$wrel <- rural$W/mean(rural$W)
rural$x1 <- log(rural$crop)
rural$x2 <- rural$x.diam
rural$x3 <- rural$x.nseeds
rural$x4 <- rural$x.peel.sugar
rural$z1 <- (rural$x1 - mean(rural$x1, na.rm = T))/sd(rural$x1, na.rm = T)
rural$z2 <- (rural$x2 - mean(rural$x2, na.rm = T))/sd(rural$x2, na.rm =T )
rural$z3 <- (rural$x3 - mean(rural$x3, na.rm = T))/sd(rural$x3, na.rm = T)
rural$z4 <- (rural$x4 - mean(rural$x4, na.rm = T))/sd(rural$x4, na.rm = T)
### Urban
ggplot(data = urban, aes(x = z1)) + xlim(-2, 4) +
geom_histogram(aes(y = ..density..), col = "black", fill = "gray", binwidth = 0.5, alpha = 0.5) +
geom_density(col = "red", fill = "red", alpha = 0.3) + theme_classic()
ggplot(data = urban, aes(x = z2)) + xlim(-4, 4) +
geom_histogram(aes(y = ..density..), col = "black", fill = "gray", binwidth = 0.5, alpha = 0.5) +
geom_density(col = "red", fill = "red", alpha = 0.3) + theme_classic()
ggplot(data = urban, aes(x = z3)) + xlim(-4, 4) +
geom_histogram(aes(y = ..density..), col = "black", fill = "gray", binwidth = 0.5, alpha = 0.5) +
geom_density(col = "red", fill = "red", alpha = 0.3) + theme_classic()
ggplot(data = urban, aes(x = z4)) + xlim(-4, 4) +
geom_histogram(aes(y = ..density..), col = "black", fill = "gray", binwidth = 0.5, alpha = 0.5) +
geom_density(col = "red", fill = "red", alpha = 0.3) + theme_classic()
# Multivariate normality test
mvn(data.frame(urban$z1, urban$z2, urban$z3, urban$z4), mvnTest = "hz")$multivariateNormality
# Q-Q plots
layout(matrix(1:4, 2, 2))
qqnorm(urban$z1, cex = 1.5, pch = 19, col = rgb(red = 0, green = 0, blue = 0, alpha = 0.3), main = "Fruit crop size")
qqline(urban$z1, col = "red", lwd = 2)
qqnorm(urban$z2, cex = 1.5, pch = 19, col = rgb(red = 0, green = 0, blue = 0, alpha = 0.3), main = "Mean fruit diameter")
qqline(urban$z2, col = "red", lwd = 2)
qqnorm(urban$z3, cex = 1.5, pch = 19, col = rgb(red = 0, green = 0, blue = 0, alpha = 0.3), main = "Mean seed number")
qqline(urban$z3, col = "red", lwd = 2)
qqnorm(urban$z4, cex = 1.5, pch = 19, col = rgb(red = 0, green = 0, blue = 0, alpha = 0.3), main = "Mean peel soluble carbohydrate concentration")
qqline(urban$z4, col = "red", lwd = 2)
layout(1)
### Semiurban
ggplot(data = semiurban, aes(x = z1)) + xlim(-2, 4) +
geom_histogram(aes(y = ..density..), col = "black", fill = "gray", binwidth = 0.5, alpha = 0.5) +
geom_density(col = "red", fill = "red", alpha = 0.3) + theme_classic()
ggplot(data = semiurban, aes(x = z2)) + xlim(-4, 4) +
geom_histogram(aes(y = ..density..), col = "black", fill = "gray", binwidth = 0.5, alpha = 0.5) +
geom_density(col = "red", fill = "red", alpha = 0.3) + theme_classic()
ggplot(data = semiurban, aes(x = z3)) + xlim(-4, 4) +
geom_histogram(aes(y = ..density..), col = "black", fill = "gray", binwidth = 0.5, alpha = 0.5) +
geom_density(col = "red", fill = "red", alpha = 0.3) + theme_classic()
ggplot(data = semiurban, aes(x = z4)) + xlim(-4, 4) +
geom_histogram(aes(y = ..density..), col = "black", fill = "gray", binwidth = 0.5, alpha = 0.5) +
geom_density(col = "red", fill = "red", alpha = 0.3) + theme_classic()
# Multivariate normality test
mvn(data.frame(semiurban$z1, semiurban$z2, semiurban$z3, semiurban$z4), mvnTest = "hz")$multivariateNormality
# Q-Q plots
layout(matrix(1:4, 2, 2))
qqnorm(semiurban$z1, cex = 1.5, pch = 19, col = rgb(red = 0, green = 0, blue = 0, alpha = 0.3), main = "Fruit crop size")
qqline(semiurban$z1, col = "red", lwd = 2)
qqnorm(semiurban$z2, cex = 1.5, pch = 19, col = rgb(red = 0, green = 0, blue = 0, alpha = 0.3), main = "Mean fruit diameter")
qqline(semiurban$z2, col = "red", lwd = 2)
qqnorm(semiurban$z3, cex = 1.5, pch = 19, col = rgb(red = 0, green = 0, blue = 0, alpha = 0.3), main = "Mean seed number")
qqline(semiurban$z3, col = "red", lwd = 2)
qqnorm(semiurban$z4, cex = 1.5, pch = 19, col = rgb(red = 0, green = 0, blue = 0, alpha = 0.3), main = "Mean peel soluble carbohydrate concentration")
qqline(semiurban$z4, col = "red", lwd = 2)
layout(1)
### Rural
ggplot(data = rural, aes(x = z1)) + xlim(-2, 4) +
geom_histogram(aes(y = ..density..), col = "black", fill = "gray", binwidth = 0.5, alpha = 0.5) +
geom_density(col = "red", fill = "red", alpha = 0.3) + theme_classic()
ggplot(data = rural, aes(x = z2)) + xlim(-4, 4) +
geom_histogram(aes(y = ..density..), col = "black", fill = "gray", binwidth = 0.5, alpha = 0.5) +
geom_density(col = "red", fill = "red", alpha = 0.3) + theme_classic()
ggplot(data = rural, aes(x = z3)) + xlim(-4, 4) +
geom_histogram(aes(y = ..density..), col = "black", fill = "gray", binwidth = 0.5, alpha = 0.5) +
geom_density(col = "red", fill = "red", alpha = 0.3) + theme_classic()
ggplot(data = rural, aes(x = z4)) + xlim(-4, 4) +
geom_histogram(aes(y = ..density..), col = "black", fill = "gray", binwidth = 0.5, alpha = 0.5) +
geom_density(col = "red", fill = "red", alpha = 0.3) + theme_classic()
# Multivariate normality test
mvn(data.frame(rural$z1, rural$z2, rural$z3, rural$z4), mvnTest = "hz")$multivariateNormality
# Q-Q plots
layout(matrix(1:4, 2, 2))
qqnorm(rural$z1, cex = 1.5, pch = 19, col = rgb(red = 0, green = 0, blue = 0, alpha = 0.3), main = "Fruit crop size")
qqline(rural$z1, col = "red", lwd = 2)
qqnorm(rural$z2, cex = 1.5, pch = 19, col = rgb(red = 0, green = 0, blue = 0, alpha = 0.3), main = "Mean fruit diameter")
qqline(rural$z2, col = "red", lwd = 2)
qqnorm(rural$z3, cex = 1.5, pch = 19, col = rgb(red = 0, green = 0, blue = 0, alpha = 0.3), main = "Mean seed number")
qqline(rural$z3, col = "red", lwd = 2)
qqnorm(rural$z4, cex = 1.5, pch = 19, col = rgb(red = 0, green = 0, blue = 0, alpha = 0.3), main = "Mean peel soluble carbohydrate concentration")
qqline(rural$z4, col = "red", lwd = 2)
layout(1)
mvn(data.frame(urban$z1, urban$z2, urban$z3, urban$z4), mvnTest = "hz")$multivariateNormality
ggplot(data = semiurban, aes(x = z1)) + xlim(-2, 4) +
geom_histogram(aes(y = ..density..), col = "black", fill = "gray", binwidth = 0.5, alpha = 0.5) +
geom_density(col = "red", fill = "red", alpha = 0.3) + theme_classic()
ggplot(data = semiurban, aes(x = z2)) + xlim(-4, 4) +
geom_histogram(aes(y = ..density..), col = "black", fill = "gray", binwidth = 0.5, alpha = 0.5) +
geom_density(col = "red", fill = "red", alpha = 0.3) + theme_classic()
ggplot(data = semiurban, aes(x = z3)) + xlim(-4, 4) +
geom_histogram(aes(y = ..density..), col = "black", fill = "gray", binwidth = 0.5, alpha = 0.5) +
geom_density(col = "red", fill = "red", alpha = 0.3) + theme_classic()
ggplot(data = semiurban, aes(x = z4)) + xlim(-4, 4) +
geom_histogram(aes(y = ..density..), col = "black", fill = "gray", binwidth = 0.5, alpha = 0.5) +
geom_density(col = "red", fill = "red", alpha = 0.3) + theme_classic()
mvn(data.frame(semiurban$z1, semiurban$z2, semiurban$z3, semiurban$z4), mvnTest = "hz")$multivariateNormality
layout(matrix(1:4, 2, 2))
qqnorm(semiurban$z1, cex = 1.5, pch = 19, col = rgb(red = 0, green = 0, blue = 0, alpha = 0.3), main = "Fruit crop size")
qqline(semiurban$z1, col = "red", lwd = 2)
qqnorm(semiurban$z2, cex = 1.5, pch = 19, col = rgb(red = 0, green = 0, blue = 0, alpha = 0.3), main = "Mean fruit diameter")
qqline(semiurban$z2, col = "red", lwd = 2)
qqnorm(semiurban$z3, cex = 1.5, pch = 19, col = rgb(red = 0, green = 0, blue = 0, alpha = 0.3), main = "Mean seed number")
qqline(semiurban$z3, col = "red", lwd = 2)
qqnorm(semiurban$z4, cex = 1.5, pch = 19, col = rgb(red = 0, green = 0, blue = 0, alpha = 0.3), main = "Mean peel soluble carbohydrate concentration")
qqline(semiurban$z4, col = "red", lwd = 2)
layout(1)
ggplot(data = rural, aes(x = z1)) + xlim(-2, 4) +
geom_histogram(aes(y = ..density..), col = "black", fill = "gray", binwidth = 0.5, alpha = 0.5) +
geom_density(col = "red", fill = "red", alpha = 0.3) + theme_classic()
ggplot(data = rural, aes(x = z2)) + xlim(-4, 4) +
geom_histogram(aes(y = ..density..), col = "black", fill = "gray", binwidth = 0.5, alpha = 0.5) +
geom_density(col = "red", fill = "red", alpha = 0.3) + theme_classic()
ggplot(data = rural, aes(x = z3)) + xlim(-4, 4) +
geom_histogram(aes(y = ..density..), col = "black", fill = "gray", binwidth = 0.5, alpha = 0.5) +
geom_density(col = "red", fill = "red", alpha = 0.3) + theme_classic()
ggplot(data = rural, aes(x = z4)) + xlim(-4, 4) +
geom_histogram(aes(y = ..density..), col = "black", fill = "gray", binwidth = 0.5, alpha = 0.5) +
geom_density(col = "red", fill = "red", alpha = 0.3) + theme_classic()
# Multivariate normality test
mvn(data.frame(rural$z1, rural$z2, rural$z3, rural$z4), mvnTest = "hz")$multivariateNormality
layout(matrix(1:4, 2, 2))
qqnorm(rural$z1, cex = 1.5, pch = 19, col = rgb(red = 0, green = 0, blue = 0, alpha = 0.3), main = "Fruit crop size")
qqline(rural$z1, col = "red", lwd = 2)
qqnorm(rural$z2, cex = 1.5, pch = 19, col = rgb(red = 0, green = 0, blue = 0, alpha = 0.3), main = "Mean fruit diameter")
qqline(rural$z2, col = "red", lwd = 2)
qqnorm(rural$z3, cex = 1.5, pch = 19, col = rgb(red = 0, green = 0, blue = 0, alpha = 0.3), main = "Mean seed number")
qqline(rural$z3, col = "red", lwd = 2)
qqnorm(rural$z4, cex = 1.5, pch = 19, col = rgb(red = 0, green = 0, blue = 0, alpha = 0.3), main = "Mean peel soluble carbohydrate concentration")
qqline(rural$z4, col = "red", lwd = 2)
layout(1)
cor(cbind(urban$z1, urban$z2, urban$z3, urban$z4), use = "complete.obs")
cor(cbind(semiurban$z1, semiurban$z2, semiurban$z3, semiurban$z4), use = "complete.obs")
cor(cbind(rural$z1, rural$z2, rural$z3, rural$z4), use = "complete.obs")
round(cor(cbind(urban$z1, urban$z2, urban$z3, urban$z4), use = "complete.obs"), 2)
round(cor(cbind(semiurban$z1, semiurban$z2, semiurban$z3, semiurban$z4), use = "complete.obs"), 2)
round(cor(cbind(rural$z1, rural$z2, rural$z3, rural$z4), use = "complete.obs"), 2)
### Urban
ggplot(data = urban, aes(x = z1)) + xlim(-2, 4) +
geom_histogram(aes(y = ..density..), col = "black", fill = "gray", binwidth = 0.5, alpha = 0.5) +
geom_density(col = "red", fill = "red", alpha = 0.3) + theme_classic()
ggplot(data = urban, aes(x = z2)) + xlim(-4, 4) +
geom_histogram(aes(y = ..density..), col = "black", fill = "gray", binwidth = 0.5, alpha = 0.5) +
geom_density(col = "red", fill = "red", alpha = 0.3) + theme_classic()
ggplot(data = urban, aes(x = z3)) + xlim(-4, 4) +
geom_histogram(aes(y = ..density..), col = "black", fill = "gray", binwidth = 0.5, alpha = 0.5) +
geom_density(col = "red", fill = "red", alpha = 0.3) + theme_classic()
ggplot(data = urban, aes(x = z4)) + xlim(-4, 4) +
geom_histogram(aes(y = ..density..), col = "black", fill = "gray", binwidth = 0.5, alpha = 0.5) +
geom_density(col = "red", fill = "red", alpha = 0.3) + theme_classic()
# Multivariate normality test
mvn(data.frame(urban$z1, urban$z2, urban$z3, urban$z4), mvnTest = "hz")$multivariateNormality
# Q-Q plots
layout(matrix(1:4, 2, 2))
qqnorm(urban$z1, cex = 1.5, pch = 19, col = rgb(red = 0, green = 0, blue = 0, alpha = 0.3), main = "Fruit crop size")
qqline(urban$z1, col = "red", lwd = 2)
qqnorm(urban$z2, cex = 1.5, pch = 19, col = rgb(red = 0, green = 0, blue = 0, alpha = 0.3), main = "Mean fruit diameter")
qqline(urban$z2, col = "red", lwd = 2)
qqnorm(urban$z3, cex = 1.5, pch = 19, col = rgb(red = 0, green = 0, blue = 0, alpha = 0.3), main = "Mean seed number")
qqline(urban$z3, col = "red", lwd = 2)
qqnorm(urban$z4, cex = 1.5, pch = 19, col = rgb(red = 0, green = 0, blue = 0, alpha = 0.3), main = "Mean peel soluble carbohydrate concentration")
qqline(urban$z4, col = "red", lwd = 2)
layout(1)
### Semiurban
ggplot(data = semiurban, aes(x = z1)) + xlim(-2, 4) +
geom_histogram(aes(y = ..density..), col = "black", fill = "gray", binwidth = 0.5, alpha = 0.5) +
geom_density(col = "red", fill = "red", alpha = 0.3) + theme_classic()
ggplot(data = semiurban, aes(x = z2)) + xlim(-4, 4) +
geom_histogram(aes(y = ..density..), col = "black", fill = "gray", binwidth = 0.5, alpha = 0.5) +
geom_density(col = "red", fill = "red", alpha = 0.3) + theme_classic()
ggplot(data = semiurban, aes(x = z3)) + xlim(-4, 4) +
geom_histogram(aes(y = ..density..), col = "black", fill = "gray", binwidth = 0.5, alpha = 0.5) +
geom_density(col = "red", fill = "red", alpha = 0.3) + theme_classic()
ggplot(data = semiurban, aes(x = z4)) + xlim(-4, 4) +
geom_histogram(aes(y = ..density..), col = "black", fill = "gray", binwidth = 0.5, alpha = 0.5) +
geom_density(col = "red", fill = "red", alpha = 0.3) + theme_classic()
# Multivariate normality test
mvn(data.frame(semiurban$z1, semiurban$z2, semiurban$z3, semiurban$z4), mvnTest = "hz")$multivariateNormality
# Q-Q plots
layout(matrix(1:4, 2, 2))
qqnorm(semiurban$z1, cex = 1.5, pch = 19, col = rgb(red = 0, green = 0, blue = 0, alpha = 0.3), main = "Fruit crop size")
qqline(semiurban$z1, col = "red", lwd = 2)
qqnorm(semiurban$z2, cex = 1.5, pch = 19, col = rgb(red = 0, green = 0, blue = 0, alpha = 0.3), main = "Mean fruit diameter")
qqline(semiurban$z2, col = "red", lwd = 2)
qqnorm(semiurban$z3, cex = 1.5, pch = 19, col = rgb(red = 0, green = 0, blue = 0, alpha = 0.3), main = "Mean seed number")
qqline(semiurban$z3, col = "red", lwd = 2)
qqnorm(semiurban$z4, cex = 1.5, pch = 19, col = rgb(red = 0, green = 0, blue = 0, alpha = 0.3), main = "Mean peel soluble carbohydrate concentration")
qqline(semiurban$z4, col = "red", lwd = 2)
layout(1)
### Rural
ggplot(data = rural, aes(x = z1)) + xlim(-2, 4) +
geom_histogram(aes(y = ..density..), col = "black", fill = "gray", binwidth = 0.5, alpha = 0.5) +
geom_density(col = "red", fill = "red", alpha = 0.3) + theme_classic()
ggplot(data = rural, aes(x = z2)) + xlim(-4, 4) +
geom_histogram(aes(y = ..density..), col = "black", fill = "gray", binwidth = 0.5, alpha = 0.5) +
geom_density(col = "red", fill = "red", alpha = 0.3) + theme_classic()
ggplot(data = rural, aes(x = z3)) + xlim(-4, 4) +
geom_histogram(aes(y = ..density..), col = "black", fill = "gray", binwidth = 0.5, alpha = 0.5) +
geom_density(col = "red", fill = "red", alpha = 0.3) + theme_classic()
ggplot(data = rural, aes(x = z4)) + xlim(-4, 4) +
geom_histogram(aes(y = ..density..), col = "black", fill = "gray", binwidth = 0.5, alpha = 0.5) +
geom_density(col = "red", fill = "red", alpha = 0.3) + theme_classic()
# Multivariate normality test
mvn(data.frame(rural$z1, rural$z2, rural$z3, rural$z4), mvnTest = "hz")$multivariateNormality
# Q-Q plots
layout(matrix(1:4, 2, 2))
qqnorm(rural$z1, cex = 1.5, pch = 19, col = rgb(red = 0, green = 0, blue = 0, alpha = 0.3), main = "Fruit crop size")
qqline(rural$z1, col = "red", lwd = 2)
qqnorm(rural$z2, cex = 1.5, pch = 19, col = rgb(red = 0, green = 0, blue = 0, alpha = 0.3), main = "Mean fruit diameter")
qqline(rural$z2, col = "red", lwd = 2)
qqnorm(rural$z3, cex = 1.5, pch = 19, col = rgb(red = 0, green = 0, blue = 0, alpha = 0.3), main = "Mean seed number")
qqline(rural$z3, col = "red", lwd = 2)
qqnorm(rural$z4, cex = 1.5, pch = 19, col = rgb(red = 0, green = 0, blue = 0, alpha = 0.3), main = "Mean peel soluble carbohydrate concentration")
qqline(rural$z4, col = "red", lwd = 2)
layout(1)
# Pearson correlation between traits
round(cor(cbind(urban$z1, urban$z2, urban$z3, urban$z4), use = "complete.obs"), 2)
round(cor(cbind(semiurban$z1, semiurban$z2, semiurban$z3, semiurban$z4), use = "complete.obs"), 2)
round(cor(cbind(rural$z1, rural$z2, rural$z3, rural$z4), use = "complete.obs"), 2)
mvntest <- mvn(data.frame(rural$z1, rural$z2, rural$z3, rural$z4), mvnTest = "hz")
mvntest$multivariateNormality
mvn(data.frame(urban$z1, urban$z2, urban$z3, urban$z4))$multivariateNormality
mvn(data.frame(urban$z1, urban$z2, urban$z3, urban$z4))
mvn
??"mvn"
